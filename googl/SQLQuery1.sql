select  YEAR(CREATED_ON_DT) as year, DateName( month , DateAdd( month , Month(CREATED_ON_DT) , -1 ) ) as month, count(estimate_id_sq) as cases, sum(ESTIMATE_HOUR_PRD) as total_hours,isnull(sum(OTHER_HOUR_PRD),0) as other_hours, cast(round(COALESCE((count(estimate_id_sq)/NULLIF((sum(estimate_hour_prd)+isnull(sum(OTHER_HOUR_PRD),0)), 0)),0),2) as numeric(36,2)) as average from yes_estimate_common where YEAR(CREATED_ON_DT)>1996 and convert(date,CREATED_ON_DT) < '6/14/2017' and convert(date,CREATED_ON_DT) > '6/14/2015'  group by MONTH(CREATED_ON_DT), YEAR(CREATED_ON_DT) order by YEAR(CREATED_ON_DT) desc,MONTH(CREATED_ON_DT) asc; 

